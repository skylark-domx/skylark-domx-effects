{"version":3,"sources":["plugins/fold.js"],"names":["define","langx","$","effects","options","done","doAnimate","element","properties","duration","ease","d","Deferred","animate","resolve","promise","this","mode","show","hide","size","percent","exec","horizFirst","ref","placeholder","createPlaceholder","start","cssClip","animation1","clip","mixin","animation2","distance","parseInt","css","clipToBox","funcs","push","easing","reduce","prev","curr","index","array","then"],"mappings":";;;;;;;AAAAA,QACC,sBACA,sBACA,cACE,SAASC,EAAMC,EAAEC,GACpB,MAAOA,GAAQH,OAAQ,OAAQ,OAAQ,SAAUI,EAASC,GA0CzD,QAASC,GAAUC,EAAQC,EAAYC,EAAUC,GAChD,MAAO,YACN,GAAIC,GAAI,GAAIC,EAKZ,OAHAL,GAAQM,QAASL,EAAYC,EAAUC,EAAM,WAC5CC,EAAEG,YAEIH,EAAEI,SA9CX,GAAIR,GAAUL,EAAGc,MAChBC,EAAOb,EAAQa,KACfC,EAAgB,SAATD,EACPE,EAAgB,SAATF,EACPG,EAAOhB,EAAQgB,MAAQ,GACvBC,EAAU,YAAYC,KAAMF,GAC5BG,IAAenB,EAAQmB,WACvBC,EAAMD,GAAe,QAAS,WAAe,SAAU,SACvDd,EAAWL,EAAQK,SAAW,EAE9BgB,EAActB,EAAQuB,kBAAmBnB,GAEzCoB,EAAQpB,EAAQqB,UAChBC,GAAeC,KAAM7B,EAAM8B,SAAWJ,IACtCK,GAAeF,KAAM7B,EAAM8B,SAAWJ,IAEtCM,GAAaN,EAAOH,EAAK,IAAOG,EAAOH,EAAK,IAGxCH,KACJD,EAAOc,SAAUb,EAAS,GAAK,IAAO,IAAMY,EAAUd,EAAO,EAAI,IAElEU,EAAWC,KAAMN,EAAK,IAAQJ,EAC9BY,EAAWF,KAAMN,EAAK,IAAQJ,EAC9BY,EAAWF,KAAMN,EAAK,IAAQ,EAEzBN,IACJX,EAAQqB,QAASI,EAAWF,MACvBL,GACJA,EAAYU,IAAKhC,EAAQiC,UAAWJ,IAGrCA,EAAWF,KAAOH,EAInB,IAAIf,GAAWX,EAAMW,SACjByB,IAcCZ,KACJY,EAAMC,KAAKhC,EAAUmB,EAAYtB,EAAQiC,UAAWP,GAAcpB,EAAUL,EAAQmC,SACpFF,EAAMC,KAAKhC,EAAUmB,EAAYtB,EAAQiC,UAAWJ,GAAcvB,EAAUL,EAAQmC,UAGrFF,EAAMC,KAAKhC,EAAUC,EAAQsB,EAAYpB,EAAUL,EAAQmC,SAC3DF,EAAMC,KAAKhC,EAAUC,EAAQyB,EAAYvB,EAAUL,EAAQmC,SAE3DF,EAAMC,KAAKjC,GACXgC,EAAMG,OAAO,SAASC,EAAMC,EAAMC,EAAOC,GACtC,MAAOH,GAAKI,KAAKH,IACjB9B,EAASE","file":"../../plugins/fold.js","sourcesContent":["define( [\r\n\t\"skylark-langx/langx\",\r\n\t\"skylark-utils/query\",\r\n\t\"../effects\"\r\n], function(langx,$,effects) {\r\nreturn effects.define( \"fold\", \"hide\", function( options, done ) {\r\n\r\n\t// Create element\r\n\tvar element = $( this ),\r\n\t\tmode = options.mode,\r\n\t\tshow = mode === \"show\",\r\n\t\thide = mode === \"hide\",\r\n\t\tsize = options.size || 15,\r\n\t\tpercent = /([0-9]+)%/.exec( size ),\r\n\t\thorizFirst = !!options.horizFirst,\r\n\t\tref = horizFirst ? [ \"right\", \"bottom\" ] : [ \"bottom\", \"right\" ],\r\n\t\tduration = options.duration / 2,\r\n\r\n\t\tplaceholder = effects.createPlaceholder( element ),\r\n\r\n\t\tstart = element.cssClip(),\r\n\t\tanimation1 = { clip: langx.mixin( {}, start ) },\r\n\t\tanimation2 = { clip: langx.mixin( {}, start ) },\r\n\r\n\t\tdistance = [ start[ ref[ 0 ] ], start[ ref[ 1 ] ] ];\r\n\r\n\r\n\tif ( percent ) {\r\n\t\tsize = parseInt( percent[ 1 ], 10 ) / 100 * distance[ hide ? 0 : 1 ];\r\n\t}\r\n\tanimation1.clip[ ref[ 0 ] ] = size;\r\n\tanimation2.clip[ ref[ 0 ] ] = size;\r\n\tanimation2.clip[ ref[ 1 ] ] = 0;\r\n\r\n\tif ( show ) {\r\n\t\telement.cssClip( animation2.clip );\r\n\t\tif ( placeholder ) {\r\n\t\t\tplaceholder.css( effects.clipToBox( animation2 ) );\r\n\t\t}\r\n\r\n\t\tanimation2.clip = start;\r\n\t}\r\n\r\n\t// Animate\r\n\tvar Deferred = langx.Deferred;\r\n\tvar funcs = [];\r\n\r\n\tfunction doAnimate(element,properties, duration, ease) {\r\n\t\treturn function() {\r\n\t\t\tvar d = new Deferred();\r\n\r\n\t\t\telement.animate( properties, duration, ease ,function(){\r\n\t\t\t\td.resolve();\r\n\t\t\t});\r\n\t\t\treturn d.promise;\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tif ( placeholder ) {\r\n\t\tfuncs.push(doAnimate(placeholder,effects.clipToBox( animation1 ), duration, options.easing ));\r\n\t\tfuncs.push(doAnimate(placeholder,effects.clipToBox( animation2 ), duration, options.easing ));\r\n\t}\r\n\r\n\tfuncs.push(doAnimate(element,animation1, duration, options.easing ));\r\n\tfuncs.push(doAnimate(element,animation2, duration, options.easing ));\r\n\r\n\tfuncs.push(done);\r\n\tfuncs.reduce(function(prev, curr, index, array) {\r\n  \t\treturn prev.then(curr);\r\n\t}, Deferred.resolve());\r\n\t\r\n} );\r\n\r\n});\r\n"]}